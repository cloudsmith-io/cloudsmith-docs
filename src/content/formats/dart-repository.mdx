import { Note, Video } from '@/components';

# Dart Repository

Cloudsmith provides public & private repositories for Dart packages

<Video wistiaId="bueesq2jx3"></Video>

<Note variant="warning" headline="Dart SDK Versions">
From February 28th 2025, Cloudsmith will only support Dart SDK version `2.15.1` or greater. After this date support for SDK versions `<=2.14`, and associated workflows, will no longer be supported.
</Note>

Dart is a client-optimized programming language developed by Google.

For more information on Dart, please see:

- [Dart.dev](https://dart.dev/): The official website for Dart
- [Pub.dev](https://pub.dev/): The official public repository for Dart packages

<Note variant="note" headline="Contextual Documentation">
  The examples in this document are generic. Cloudsmith provides contextual setup instructions within each repository, complete with copy and paste snippets (with your namespace/repo/rsa-key pre-configured).
</Note>

In the following examples: 

| Identifier      | Description                                                                               |
| :-------------- | :---------------------------------------------------------------------------------------- |
| OWNER           | Your Cloudsmith account name or organization name (namespace)                             |
| REPOSITORY      | Your Cloudsmith Repository name (also called "slug")                                      |
| TOKEN           | Your Cloudsmith Entitlement Token (see [Entitlements](/software-distribution/entitlement-tokens) for more details) |
| USERNAME        | Your Cloudsmith username                                                                  |
| PASSWORD        | Your Cloudsmith password                                                                  |
| API-KEY         | Your Cloudsmith API Key                                                                   |
| PACKAGE_NAME    | The name of your package                                                                  |
| PACKAGE_VERSION | The version number of your package                                                        |
| DEPENDENCY_NAME | A name for a dependency in a pubspec file                                                 |

## Upload a Package

## Publish via Dart

<Note variant="note" headline="Note">
Please note that Dart SDK version 2.15.1 or newer is required for native upload support. For older client versions, please continue to use the Cloudsmith CLI/API.
</Note>

The endpoint for the native Dart API is:

```
https://dart.cloudsmith.io/OWNER/REPOSITORY/
```

Your project `pubspec.yaml` defines the location that artifacts should be published to. Add the following to the root of this file:

```yaml
publish_to: https://dart.cloudsmith.io/OWNER/REPOSITORY/
```

In order to authenticate for native publishing, you'll need run `dart pub token`, as follows:

```shell
echo 'API-KEY' | dart pub token add https://dart.cloudsmith.io/OWNER/REPOSITORY/
Enter secret token:
Requests to "https://dart.cloudsmith.io/OWNER/REPOSITORY/" will now be authenticated using the secret token.
```

You can then publish from your project directory using `dart pub publish`:

```
dart pub publish
Uploading...
Upload complete. Package will available following synchronization.
```
<Note variant="note" headline="Limitation">
When publishing via the native API package sizes are limited to 200.0 MB per file. If this is an issue, please use the Cloudsmith CLI or API (which support up to 5GB for single-part uploads and beyond for multi-part), or contact us if that's not an option.
</Note>

### Upload via the Cloudsmith CLI

<Note variant="note" headline="Note">
Please see Dart's [documentation on creating packages](https://dart.dev/guides/libraries/create-library-packages) for more information on building your own packages.
</Note>

#### Creating Dart Packages

To upload via the Cloudsmith API/CLI, you'll need to generate a package first. While we expect the tooling in this area to improve over time, currently the process is a manual one and can be a little tricky.

You can build a package with standard command-line tooling like `tar`. To illustrate the process we'll use [cli_util](https://github.com/dart-lang/cli_util) as an example:

First, check out the version of cli_util we want to pack (**v0.1.3** for example purposes):

```shell
git clone https://github.com/dart-lang/cli_util@v0.1.3
cd cli_util
```

```shell
tar --exclude='.dart_tool' -czvf cli_util_0.1.3.tar.gz ./*
```

For full details of how to install and setup the Cloudsmith CLI, see [Command Line Interface](/developer-tools/cli).

The command to upload a Dart package via the Cloudsmith CLI is: 

```shell
cloudsmith push dart OWNER/REPOSITORY PACKAGE_NAME-PACKAGE_VERSION.tgz
```

Example:

```shell
cloudsmith push dart org/repo your-package-1.0.0.tgz
```

### Upload via Cloudsmith Website

Please see [Upload a Package](/artifact-management/package-upload) for details of how to upload via the Cloudsmith web app.

***

## Download / Install a Package

Instaling packages from this repository varies, depending on the version of the Dart SDK in use.

### SDK Version >= 2.15

**Public Repositories** 

No further setup is required when using Dart SDK >= 2.15 with public repositories, you can add a dependency from this repository to your package `pubspec.yaml` automatically with `dart pub`. See [Installing a Package](/formats/dart-repository)

**Private Repositories**

In order to authenticate, you need to run `dart pub token`, as follows:

```shell Entitlement Token Auth
echo 'TOKEN' | dart pub token add https://dart.cloudsmith.io/OWNER/REPOSITORY/
Enter secret token:
Requests to "https://dart.cloudsmith.io/OWNER/REPOSITORY/" will now be authenticated using the secret token.
```
```yaml HTTP Basic Auth (User & Pass)
echo 'PASSWORD' | dart pub token add https://dart.cloudsmith.io/OWNER/REPOSITORY/
Enter secret token:
Requests to "https://dart.cloudsmith.io/OWNER/REPOSITORY/" will now be authenticated using the secret token.
```
```yaml HTTP Basic Auth (API-Key)
echo 'API-KEY' | dart pub token add https://dart.cloudsmith.io/OWNER/REPOSITORY/
Enter secret token:
Requests to "https://dart.cloudsmith.io/OWNER/REPOSITORY/" will now be authenticated using the secret token.
```
```yaml HTTP Basic Auth (Token)
echo 'TOKEN' | dart pub token add https://dart.cloudsmith.io/OWNER/REPOSITORY/
Enter secret token:
Requests to "https://dart.cloudsmith.io/OWNER/REPOSITORY/" will now be authenticated using the secret token.
```

### SDK Version \<= 2.14

Before you can install packages from your Cloudsmith repository you'll need to configure your environment for access. The configuration is defined using the `PUB_HOSTED_URL` environment variable. 

<Note variant="warning" headline="Warning">
This approach is not recommended, and we strongly encourage the use of the method detailed for SDK 2.15 onwards. This approach has the effect of embedding access tokens within your generated `pubspec.lock file`. As these typically tend to get committed to source repositories, this is a potential attack vector.
</Note>

<Note variant="warning" headline="Warning">
When using PUB_HOSTED_URL, all dependencies must be present in the specified Cloudsmith repository. Dart repositories don't (currently) proxy upstream sources and can only serve packages explicitly uploaded to Cloudsmith. So if set, you cannot resolve any dependencies from pub.dev.  
If PUB_HOSTED_URL is unset, any packages not uploaded to Cloudsmith (and with a specific Cloudsmith URL set in the pubspec.yaml file) will be fetched from pub.dev
</Note>

**Public Repositories**

_Linux / Mac_

```shell
export PUB_HOSTED_URL=https://dl.cloudsmith.io/public/OWNER/REPOSITORY/dart/
```

_Windows (cmd)_

```shell
set PUB_HOSTED_URL=https://dl.cloudsmith.io/public/OWNER/REPOSITORY/dart/
```

_Windows (Powershell)_

```powershell
$env:PUB_HOSTED_URL=https://dl.cloudsmith.io/public/OWNER/REPOSITORY/dart/
```

**Private Repositories**

<Note variant="note" headline="Note">
Private Cloudsmith repositories require authentication.  You can choose between two types of authentication, Entitlement Token Authentication or HTTP Basic Authentication. 
The setup method will differ depending on what authentication type you choose to use.
</Note>

_Linux / Mac_

```shell Entitlement Token Auth
export PUB_HOSTED_URL=https://dl.cloudsmith.io/TOKEN/OWNER/REPOSITORY/dart/
```
```shell HTTP Basic Auth (User & Pass)
export PUB_HOSTED_URL=https://USERNAME:PASSWORD@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```shell HTTP Basic Auth (API Key)
export PUB_HOSTED_URL=https://USERNAME:API-KEY@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```shell HTTP Basic Auth (Token)
export PUB_HOSTED_URL=https://token:TOKEN@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```

_Windows (cmd)_

```text Entitlement Token Auth
set PUB_HOSTED_URL=https://dl.cloudsmith.io/TOKEN/OWNER/REPOSITORY/dart/
```
```text HTTP Basic Auth (User & Pass)
set PUB_HOSTED_URL=https://USERNAME:PASSWORD@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```text HTTP Basic Auth (API Key)
set PUB_HOSTED_URL=https://USERNAME:API-KEY@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```text HTTP Basic Auth (Token)
set PUB_HOSTED_URL=https://token:TOKEN@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```

_Windows (Powershell)_

```powershell Entitlement Token Auth
$env:PUB_HOSTED_URL=https://dl.cloudsmith.io/TOKEN/OWNER/REPOSITORY/dart/
```
```powershell HTTP Basic Auth (User & Pass)
$env:PUB_HOSTED_URL=https://USERNAME:PASSWORD@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```powershell HTTP Basic Auth (API Key)
$env:PUB_HOSTED_URL=https://USERNAME:API-KEY@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```
```powershell HTTP Basic Auth (Token)
$env:PUB_HOSTED_URL=https://token:TOKEN@dl.cloudsmith.io/basic/OWNER/REPOSITORY/dart/
```

## Installing a Package

### SDK Version >= 2.15

`dart pub` is capable of adding a dependency from this repository to your package `pubspec.yaml` automatically:

**Public Or Private Repositories**

```shell
dart pub add PACKAGE_NAME:PACKAGE_VERSION --hosted-url https://dart.cloudsmith.io/OWNER/REPOSITORY/
Resolving dependencies...
+ your-package 1.2.3
Downloading your-package 1.2.3...
Changed 1 dependency!
```

### SDK Version \<= 2.14

**Public Repositories**

A dependency may be manually added to your project `pubspec.yaml` file:

```yaml
dependencies:
 DEPENDENCY_NAME:
    hosted:
      name: PACKAGE_NAME
      url: https://dl.cloudsmith.io/public/OWNER/REPOSITORY/dart/
      version: PACKAGE_VERSION
```

**Private Repositories**

```yaml
dependencies:
  your-package:
    version: PACKAGE_VERSION
```

Once set up, pub will download the dependency to `.pub_cache`  and update the `pubspec.lock` and `.packages` after running following command:

```shell
pub get
```

Please also see the [pubspec docs](https://dart.dev/tools/pub/pubspec) for further examples of pubspec files.

## Security Scanning

<span class="cs-tag cs-tag-dark-green">Supported</span> 

Please see our [Security Scanning](/policy-management/vulnerability-policy) documentation for further information.

## Upstream Proxying / Caching

<span class="cs-tag cs-tag-dark-green">Configurable Proxying</span> <span class="cs-tag cs-tag-orange">Caching</span>  
You can configure upstream Dart repositories that you wish to use for packages that are not available in your Cloudsmith repository. Proxied Dart packages cannot currently be cached.

Please see our [Upstream Proxying](/repositories/upstreams) documentation for further instructions. 

## Key Signing Support

<span class="cs-tag cs-tag-dark-grey">Not Supported by Format</span>

## Troubleshooting

Please see the [Troubleshooting](/troubleshooting) page for further help and information.
