import { BlockImage, Note } from '@/components'
import overview from './images/client-statistics/client-statistics-overview.gif'
import overview_usage from './images/client-statistics/overview_usage.png'
import delivery_summary from './images/client-statistics/delivery_summary.png'
import package_downloads from './images/client-statistics/package_downloads.png'
import artifact_data from './images/client-statistics/artifact_data.png'
import img5b18a8e_metrics_packages from './images/client-statistics/5b18a8e-metrics-packages.png'

# Client Statistics

To access this feature, click on **Usage** on the top right corner of your Workspace/Repository Overview page.

<Note>
ðŸ“˜ Due to the addition of new features, some of the legacy graphs displayed in this section will be deprecated:
- Package delivery
- Packages
- Container images
- Open source delivery

All of the information displayed in those can be retrieved from the new graphs explained below.
</Note>

The Client Statistics page shows usage information of all access to your Workspace or Repositories. It includes the next areas:
- Overview of usage
- Delivery Summary
- Package Downloads
- Artifact Data

<BlockImage src={overview} alt="Statistics Page"></BlockImage>

### Overview of usage

The total amount accumulated during the Current Billing Cycle for:
- Package Delivery.
- Artifact Data.
- Packages.
- Container images.
- Open Source Delivery.

When applicable, it also includes a comparative with the previous comparable cycle.

<BlockImage src={overview_usage} alt="Statistics Page"></BlockImage>


### Delivery Summary

Displays a list of all of the package bandwidth for the selected time scope. The results can be grouped by package or repository, and display the trend compared with the previous comparable time scope.


All of the data available in this chart is sourced from the [Client Logs](./client-logs) feature.
Click on any of the entries in the list to view its own data in the Client Logs.

<BlockImage src={delivery_summary} alt="Statistics Page"></BlockImage>


### Package Downloads

The "Package downloads" chart presents data related to package consumption, enabling monitoring and analysis of download trends over defined periods. It displays metrics such as total downloads and bytes transferred, contributing to an understanding of artifact distribution and utilization.


<BlockImage src={package_downloads} alt="Statistics Page"></BlockImage>

The chart displays package download activity. Users can select various aggregate types, including "Bytes Downloaded Sum" for data transfer volume, or other metrics like download counts.
Basically, aggregate allows you to decide_how you want to quantify or summarize the package download activity_. Here you can find a detailed list of options available:
- **Bytes Downloaded Average**
- **Bytes Downloaded Sum**
- **Unique IP Address Count**
- **Request Count**
- **Time Taken** (Avg, Max, P50, P75, P90, P95, P99, Sum)

#### **Time Period Selection:**

- **Period:** Preconfigured options are available for historical data analysis (e.g., "Previous 12 months").
- **Date Selection:** A configurable date range picker (e.g., "10 Jun 2024 - 10 Jun 2025") allows for specific data window definition.
- **Interval:** Data can be viewed by different time intervals, such as "Month" or other available options. In order words, this is the _bucket size for which the "Aggregate" calculation is performed_.

#### **Filtering Options:** A set of filters allows for refinement of displayed data based on specific criteria

- **Package format:** Filters by package type (e.g., npm, Maven, Docker).
- **Repository type:** Filters by repository classification (e.g., private, public).
- **Repository:** Filters data for a specific repository.
- **IP address:** Filters usage originating from specific IP addresses.
- **User type:** Differentiates between user classifications.
- **User:** Filters by individual user download activity.
- **Entitlement token:** Filters usage associated with specific access tokens.

- Other filters available for **plot Configuration:**
  - **Group by:** Allows data aggregation based on selected criteria (e.g., package format, repository).
  - **Plot Type:** Options include "Interval" (data per period) and "Accumulated" (cumulative data).
  - **Scale:** Selection between "Linear" and "Log" scales for data display.

- **Reset Filters:** A "Reset Filters" function is available to restore default filter settings.

### **Purpose**

This chart serves to provide data for:

* Monitoring bandwidth consumption, and impact on billing.
* Identifying package download frequencies.
* Tracking user-specific download activities, although Client Logs might be better suited for this goal. 
* Evaluating the impact of different repositories or package formats.
* Reviewing access patterns via entitlement tokens.

### Artifact Data

Total amount of Artifact data stored within the Workspace/Repository.

<BlockImage src={artifact_data} alt="Statistics Page"></BlockImage>

This will increase with time as more artifacts are stored within your Workspace. [Retention Rules](/artifact-management/retention-rules) can help to automate storage management.


## Statistics via the CLI

You can query the number of active (has been downloaded) and inactive (has not been downloaded) packages via the Cloudsmith CLI with the `cloudsmith metrics packages` command: 

```shell
cloudsmith metrics packages OWNER/REPOSITORY
```

Example: 

```shell
cloudsmith metrics packages demo/examples-repo 
```

<BlockImage src={img5b18a8e_metrics_packages} alt="cloudsmith metrics packages"></BlockImage>

You can also query package activity during a specific time range using the `--start` and `--finish` parameters and ISO 8601 formatted datetimes.

Example: 

```shell
cloudsmith metrics packages demo/examples-repo --start=2019-01-01T00:00:00Z --finish=2019-12-31T00:00:00Z
```

### Specific Packages 

You can query one or more specific packages by adding the `--packages` flag with package identifiers as a comma-separated list  (See [Package Identification](/artifact-management/identifying-a-package) for more information).

Example:

```shell
cloudsmith metrics packages demo/examples-repo --packages=ZGCV58VqT8Sl
```