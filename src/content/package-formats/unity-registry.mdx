import { Note, Video } from '@/components';

# Unity Registry

Cloudsmith provides public & private repositories for the Unity Development Platform

<Video wistiaId="bmlsjm03zo"></Video>

For more information on Unity, please see:

- [Unity](https://unity.com/): The official website for Unity
- [Unity Docs](https://docs.unity3d.com/Manual/index.html): The official documentation for Unity
- [Unity UPM](https://docs.unity3d.com/Manual/Packages.html): Documentation for Unity's Package Manager
- [Unity UPM Scoped Registry](https://docs.unity3d.com/Manual/upm-scoped.html): Documentation to setup a Scoped Package Registry

<Note variant="note" headline="Contextual Documentation">
The examples in this document are generic. Cloudsmith provides contextual setup instructions within each repository, complete with copy and paste snippets (with your namespace/repo/rsa-key pre-configured).
</Note>

In the following examples: 

| Identifier      | Description                                                                               |
| :-------------- | :---------------------------------------------------------------------------------------- |
| OWNER           | Your Cloudsmith account name or organization name (namespace)                             |
| REPOSITORY      | Your Cloudsmith Repository name (also called "slug")                                      |
| TOKEN           | Your Cloudsmith Entitlement Token (see [Entitlements](/distributing-your-software/entitlement-tokens) for more details) |
| API-KEY         | Your Cloudsmith API Key                                                                   |
| PACKAGE_NAME    | The name of your Unity package                                                            |
| PACKAGE_VERSION | The version number of your package                                                        |

# Upload a Package

## Publish via npm

As Unity packages are compatible with npm registries,  you can publish your Unity packages to a Cloudsmith npm registry via the native npm tooling.

### Setup

The endpoint for the native npm API is:

```
https://npm.cloudsmith.io/OWNER/REPOSITORY/
```

In order to authenticate for native publishing, you can either use `npm login` or create an `npmrc` file (in your **$HOME** or in the project directory)

Use `npm login`:

```shell
npm login --registry=https://npm.cloudsmith.io/OWNER/REPOSITORY/
Username: USERNAME
Password: API-KEY
Email: YOUR-EMAIL-ADDRESS
```

Or create an `.npmrc` file with the following:

```
registry=https://npm.cloudsmith.io/OWNER/REPOSITORY/
//npm.cloudsmith.io/OWNER/REPOSITORY/:_authToken=API-KEY
```

### Publish

Once you have set up the registry, you can then publish from your project directory using `npm publish`: 

```shell
npm publish --registry=https://npm.cloudsmith.io/OWNER/REPOSITORY/
```

For more details on `npm publish` see the official [npm documentation](https://docs.npmjs.com/cli/publish). (external link)

## Upload via the Cloudsmith CLI

For full details of how to install and setup the Cloudsmith CLI, see [Command Line Interface](/getting-started/cli).

To upload via the Cloudsmith CLI / API, you'll need to generate your package first. You can do this with:

```shell
npm pack
```

This will generate a tarball file (.tgz) like `your-package-1.2.3.tgz` that you can upload.

<Note variant="note" headline="Note">
This assumes that you've created a `project.json` file for your project. Please see the official npmjs [package.json reference](https://docs.npmjs.com/files/package.json) (external link) for more information.
</Note>

The command to upload a Unity package via the Cloudsmith CLI is: 

```shell
cloudsmith push npm OWNER/REPOSITORY PACKAGE_NAME-PACKAGE_VERSION.tgz
```

Example:

```shell
cloudsmith push npm your-account/your-repo com.cloudsmith.assets--1.0.0.tgz
```

## Upload via Cloudsmith Website

Please see [Upload a Package](/artifacts/package-upload) for details of how to upload via the Website UI.

# Download / Install a Package

## Public Registries

To download/install a Unity package, you need to add your Cloudsmith registry to your Unity project's `manifest.json` file as a scoped registry: 

```json
"scopedRegistries": [
    {
      "name": "NAME",
      "url": "https://npm.cloudsmith.io/OWNER/REPOSITORY/",
      "scopes": [
        "SCOPE"
      ]
    }
  ],
```

You then add the packages that you wish to download and install to the dependencies section of the project `manifest.json` file: 

```json
 "dependencies": {
    "PACKAGE_NAME": "PACKAGE_VERSION"
  }
}
```

For example: 

```json
{
  "scopedRegistries": [
    {
      "name": "MyRegistry",
      "url": "https://npm.cloudsmith.io/demo/examples-repo/",
      "scopes": [
        "com.cloudsmith",
      ]
    }
  ],
  
  "dependencies": {
    "com.cloudsmith.assets": 1.1.2"
  }
}
```

For further information, please see the Unity documentation on [Scoped Registries](https://docs.unity3d.com/Manual/upm-scoped.html).

## Private Registries

To download/install a Unity package from a private Cloudsmith registry:

1. Add the registry and dependencies to your project's `manifest.json` as per the instructions for public registries 
2. Locate the `upmconfig.toml` file and add the one of the following, depending on which authentication method you wish to use:  

```toml Entitlement Token Auth
[npmAuth."https://npm.cloudsmith.io/OWNER/REPOSITORY/"]
token = "TOKEN"
email = "EMAIL"    OPTIONAL
alwaysAuth = true  OPTIONAL
```
```toml API Key Auth
[npmAuth."https://npm.cloudsmith.io/OWNER/REPOSITORY/"]
token = "API-KEY"
email = "EMAIL"    OPTIONAL
alwaysAuth = true  OPTIONAL
```

If the file does not already exist, create an empty text file.

<Note variant="warning" headline="Warning">
Entitlement Tokens, User Credentials and API-Keys should be treated as secrets, and you should ensure that you do not commit them in configurations files along with source code or expose them in any logs.
</Note>

Unity Package Manager Global configuration file location:

| Environment     | Location                                         |
| :-------------- | :----------------------------------------------- |
| Windows         | %ALLUSERSPROFILE%\\Unity\\config\\upmconfig.toml |
| macOS and Linux | /etc/upmconfig.toml                              |

Unity Package Manager User configuration file location:

| Environment     | Location                      |
| :-------------- | :---------------------------- |
| Windows         | %USERPROFILE%\.upmconfig.toml |
| macOS and Linux | ~/.upmconfig.toml             |

For further information, please see the Unity documentation on [scoped registry authentication](https://docs.unity3d.com/Manual/upm-config-scoped.html) 

## Key Signing Support

<span class="cs-tag cs-tag-blue">GPG</span>

## Troubleshooting

Please see the [Troubleshooting](doc:troubleshooting) page for further help and information.
