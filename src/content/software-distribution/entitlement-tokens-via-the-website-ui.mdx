import { Note, BlockImage } from '@/components'
import img_repo_entitlement_token_view from './images/entitlement-tokens-via-the-website-ui/0ffe7175e5e929058a398f3cc0d17a74653af0a0cd71a95cbaaeb06ca81c6d31-repo-entitlement-token-view.png'
import img_repo_entitlement_filter from './images/entitlement-tokens-via-the-website-ui/a0a0bb8503c20979dff808273d0cbb805dcf6fa7ffd075a3765dbb375d1d4ee9-repo-entitlement-filter.png'
import img_create_entitlement_token_button from './images/entitlement-tokens-via-the-website-ui/7ddb11318a6d95e953f239e8ba5b59cb79714dfec2f8fa2c5902b13c0bab082a-create-entitlement-token-button.png'
import img_create_entitlement_token_form from './images/entitlement-tokens-via-the-website-ui/839c28b5549b7db2c336e87e755fc763d67b69174271cfaca20ddde9babc1a42-create-entitlement-token-form.png'
import img_edit_entitlement_token_button from './images/entitlement-tokens-via-the-website-ui/d66342df2765378ca4725625f83798f9089831a3e093508ea8c93050852d2ce7-edit-entitlement-token-button.png'
import img_edit_entitlement_token_form from './images/entitlement-tokens-via-the-website-ui/30638987197b370541889ae9815440c016b041f2d74b8ae4d002ee472b3945c4-edit-entitlement-token-form.png'
import img_entitlement_token_secret from './images/entitlement-tokens-via-the-website-ui/289b0a001955342079a38afca26a703d2264e1ca2040ec844659140185095190-entitlement-token-secret.png'
import img_entitlement_token_set_secret from './images/entitlement-tokens-via-the-website-ui/569455ac44993f0c7cfea73f580437e76fb462527be50ecdf3b782f724dd6b38-entitlement-token-set-secret.png'
import img_entitlement_token_set_secret_form from './images/entitlement-tokens-via-the-website-ui/222f2a96b853a92d0cc081582a5510957e28ee65825648eff991e25cfc10dc62-entitlement-token-set-secret-form.png'
import img_entitlement_token_reset_statistics from './images/entitlement-tokens-via-the-website-ui/c6eb2c11954f05be831eb6aa59d43abb3eb12c38a229a987c191a932b3584767-entitlement-token-reset-statistics.png'
import img_entitlement_token_reset_confirm from './images/entitlement-tokens-via-the-website-ui/04f2707990c4b6a87e28c54144c63cbb4e6e003e927b2abbed992382db3b012f-entitlement-token-reset-confirm.png'
import img_entitlement_token_refresh from './images/entitlement-tokens-via-the-website-ui/b505f6623da262866528daf2b17a20daba3f54732375bbcb9dfe20de8adcd881-entitlement-token-refresh.png'
import img_entitlement_token_refresh_confirm from './images/entitlement-tokens-via-the-website-ui/35d3f986c948596fbad5b29d4e80b3560aac618d94fd59e743b6f42ea76058d0-entitlement-token-refresh-confirm.png'
import img_entitlement_token_sync_button from './images/entitlement-tokens-via-the-website-ui/3233a19fcbbb90741c43ef9dd98b11e749605a93b11aa47c7fe53f60784ae48a-entitlement-token-sync-button.png'
import img_entitlement_token_sync_confirm from './images/entitlement-tokens-via-the-website-ui/ab860f3449e0c6df4df3c0260929c3118e9d9c27220d1b832cf48e88058104b6-entitlement-token-sync-confirm.png'
import img_entitlement_token_delete_button from './images/entitlement-tokens-via-the-website-ui/71ed29321c1e2c78fcacde7fe49cd56346d7ec9ac2709a7007e0e985748ebe2d-entitlement-token-delete-button.png'
import img_entitlement_token_delete_confirm from './images/entitlement-tokens-via-the-website-ui/f6116115978507b8a7cd8a0151dea78565bd03ddf41adbceca8caa9d7ff10019-entitlement-token-delete-confirm.png'

# Entitlements via the UI

## Viewing Entitlement Tokens

To view Entitlement Tokens for a repository, click the "Settings" tab, then click "Entitlement Tokens": 

<BlockImage src={img_repo_entitlement_token_view} alt="Viewing Entitlement Tokens"></BlockImage>

## Searching Entitlement Tokens

You can search / filter tokens using the "Filter Tokens field:

<BlockImage src={img_repo_entitlement_filter} alt="Entitlement Token Search"></BlockImage>

When filtering/searching Entitlement Tokens, you can use the following search criteria with boolean logic (e.g. AND/OR/NOT) for complex search queries:

| Search Query                   | Description                                                                                                                  |
| :----------------------------- | :--------------------------------------------------------------------------------------------------------------------------- |
| Name                           | The Token Name. For Example: `name:some-name`                                                                                |
| Identifier                     | The Token Identifier. For Example: `identifier:abced12345`                                                                   |
| Active                         | If the Token is Active or Disabled, either `true`or `false` For Example: `active:false`                                      |
| No. of clients (since reset)   | The Number of Client IP addresses that have used the token since the usage counter was last reset. For Example: `clients:>1` |
| No. of downloads (since reset) | The Number of package downloads attributed to the Token since the usage counter was last reset. For Example: `downloads:>1`  |
| Bandwidth limit                | The bandwidth limit for a Token. For Example: `bandwidth_limit:100`                                                          |
| Bandwidth limit unit           | The units for a bandwidth limit. For Example `bandwidth_limit_unit:GB`                                                       |
| Bandwidth usage (since reset)  | The bandwidth used by a Token since the usage counter was last reset. For Example: `bandwidth_usage:>10`                     |
| Token Type                     | The Token Type (Standard Token or User Token). For Example `token_type:standard`                                             |
| User                           | User Name, for user-based tokens. For Example: `user:foo`                                                                    |
| Created date                   | The Token creation date. For Example: `created:>10/10/2024`                                                                  |
| Last usage reset date          | The date the usage counter for the token was last reset. For Example `last_reset:>10/10/2024`                                |
| Limit from date                | The date that the token will be valid from. For Example:`limit_date_from:10/10/2024`                                         |
| Limit to date                  | The date that the token will be valid until. For Example: `limit_date_to:10/10/2024`                                         |

## Creating Entitlement Tokens

You can create and configure Entitlement Tokens via the Cloudsmith web app by clicking the "Settings" tab in a repository, then click "Entitlement token", the click the blue "Create New Token" button: 

<BlockImage src={img_create_entitlement_token_button} alt="Create Token Button"></BlockImage>

You will then be presented with a form where you can name the token and configure permissions/restrictions that the token grants on the repository:  

<BlockImage src={img_create_entitlement_token_form} alt="Create Token Form"></BlockImage>

### Visibility Restrictions

You can add visibility restrictions to a token which will control what packages the token has access to: 

| Restriction            | Description                                                                                                                                                                                                                                                                                                                                                                                       |
| :--------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Restrict by Search** | The package-based search query to apply to restrict downloads to. This uses the same syntax as the standard search used for repositories (see [Searching / Filtering](/artifact-management/search-filter-sort-packages) for more details). This will still allow access to non-package files, such as metadata. For package formats that support dynamic metadata indexes, the contents of the metadata will also be filtered. |

### Usage Limits

You can add usage limits restrictions to a token which will control how the token can be used.  The configurable restrictions are:

|Limit|Description|
|:---|:---|
|**Statistics Reset Interval**|A token reset refreshes the maximum downloads, clients/IPs, and bandwidth restrictions to zero and maintains the existing limits. The reset period used will be used to automatically trigger a reset of the token limits during the configured period.|
|**Valid From (UTC)**|The starting date/time the token is allowed to be used from.|
|**Expires at (UTC)**|The ending date/time the token is allowed to be used until.|
|**Maximum Downloads**|The maximum number of downloads allowed for the token. Please note that since downloads are calculated asynchronously (after the download happens), the limit may not be imposed immediately but at a later point."|
|**Maximum Clients/IPs**|The maximum number of unique clients allowed for the token. Please note that since clients are calculated asynchronously (after the download happens), the limit may not be imposed immediately but at a later point.|
|**Maximum Bandwidth**|The maximum download bandwidth usage allowed for the token.  Please note that since downloads are calculated asynchronously (after the download happens), the limit may not be imposed immediately but at a later point.|
|**Unit of Bandwidth**|The selected unit of bandwidth to apply to the Maximum Bandwidth restriction. **Please Note** 1GB = 1000000000 (1000^3) Bytes, not 1073741824 (1024^3) Bytes.|

<Note variant="note">
  Please see [Sharing a Private Package](/artifact-management/sharing-a-private-package) for an example of configuring an Entitlement Token using the Cloudsmith web app.
</Note>

### Additional Metadata

In addition, you can optionally add metadata to the token that is specific to your use case. This could be used to store information such as licensing information, but the format and contents are defined by you.  You add this metadata as JSON into the "Token Metadata (JSON)" field: 

### EULA Acceptance

<Note variant="note">
  EULA for Entitlement Tokens is in Early Access. If you'd like to be included in early access to this feature please [contact us](https://cloudsmith.com/company/contact-us).
</Note>

You can specify that a EULA must be accepted before an Entitlement is enabled:  

If checked, then a client will be compelled to go to the token-based URL for EULA acceptance, before they are able to use the token to download files. Note that this also requires EULA enforcement to be enabled on the repository.

## Editing Entitlement Tokens

Editing an Entitlement Token allows you to change the token name, modify any permissions/restrictions associated with the token or change the token's metadata.

You edit an Entitlement Token by clicking the dots to the right of a token and then clicking "Edit Token":

<BlockImage src={img_edit_entitlement_token_button} alt="Edit Token Button"></BlockImage>

<Note variant="note">
  User Entitlement Tokens cannot be edited.
</Note>

You are then presented with the Edit Entitlement Token form where you can make any changes and click the "Save" button to apply them: 

<BlockImage src={img_edit_entitlement_token_form} alt="Edit Token Form"></BlockImage>

## Setting an Entitlement Token

When you create an Entitlement Token, we generate a random string for the token secret itself and it is this secret that will be used in configuration files that use the token.  

The token is not displayed in the Cloudsmith web app but can be copied using the copy button beside the secret: 

<BlockImage src={img_entitlement_token_secret} alt="Token Field"></BlockImage>

Setting an Entitlement Token secret allows you to use your own custom string for an Entitlement Token secret.  Please note, setting a custom string for a token will not change the token name or any permissions/restrictions associated with the token, but it will have the effect of invalidating any users/clients using the current token.

You set an Entitlement Token secret by clicking the dots to the right of a token and then clicking "Set Token": 

<BlockImage src={img_entitlement_token_set_secret} alt="Set Token Button"></BlockImage>

You will then be presented with the Set Token form, where you have to confirm the repository slug/identifier (to prevent the accidental setting of a token) and enter the new string for the token: 

<BlockImage src={img_entitlement_token_set_secret_form} alt="Set Token Form"></BlockImage>

<Note variant="note">
  If you specify a custom string for a token, it must be between 8 - 48 characters in length. It must only contain alphanumerics, dashes, dots or underscores and it must begin with an alphanumeric.
</Note>

## Resetting Entitlement Token Statistics

Resetting Entitlement Token Statistics will reset the download and client counts to zero. 

You can reset the statistics associated with an Entitlement Token by clicking the dots to the right of a token and then clicking "Reset Token Statistics": 

<BlockImage src={img_entitlement_token_reset_statistics} alt="Reset Token Statistics Button"></BlockImage>

You will then be presented with the Reset Token Statistics form where you must confirm the current repository slug/identifier (to prevent accidental resets of statistics) and then click the "Confirm" button: 

<BlockImage src={img_entitlement_token_reset_confirm} alt="Reset Token Statistics Form"></BlockImage>

## Refreshing Entitlement Tokens

Refreshing will generate a new Entitlement Token secret and this will invalidate the current token in use by existing users/clients. Refreshing an Entitlement Token will not change the token name, or any restrictions/permissions associated with the token, it just generates a new token secret itself.  As long as the user who created this token has privileges for this repository, they can recreate/retrieve the token at anytime

To refresh an Entitlement Token, click the dots to the right of a token and then click "Refresh Token":

<BlockImage src={img_entitlement_token_refresh} alt="Refresh Token Button"></BlockImage>

You will then be presented with a form that will ask you to enter the repository slug/identifier (this is to prevent accidental token refreshes), and then click "Confirm": 

<BlockImage src={img_entitlement_token_refresh_confirm} alt="Refresh Token Confirmation Form"></BlockImage>

<Note variant="note">
  A refreshed token will still be able to be used for static assets (that are cached at the Package Delivery Network) for approximately 10 minutes until the PDN has to re-authenticate once its cache expires.
</Note>

## Synchronising Entitlement Tokens

Synchronising Entitlement Tokens replaces all the tokens associated with a repository with those from another repository. This will invalidate any current tokens in use by existing users/clients.

You can synchronise Entitlement Tokens between repositories by clicking the dots to the right of the "Create New Token" button and then clicking "Sync Tokens": 

<BlockImage src={img_entitlement_token_sync_button} alt="Sync Tokens Button"></BlockImage>

You will then be presented with the Sync Tokens form, which requires you to confirm the current repository slug/identifier (to prevent the accidental synchronisation of tokens) and also choose the source repository from a drop-down list:

<BlockImage src={img_entitlement_token_sync_confirm} alt="Sync Tokens Confirmation Form"></BlockImage>

When you have confirmed the current repository slug/identifier and selected the source repository for the tokens you wish to synchronise, click "Sync Tokens"  to synchronise the tokens.

## Deleting Entitlement Tokens

You can delete an Entitlement Token via the Cloudsmith web app.  This is a soft-delete, in that the token will no longer be available for use but the history of the token will be retained for logging/auditing purposes.

To delete an Entitlement Token click the dots to the right of the token and then click "Delete token":

<BlockImage src={img_entitlement_token_delete_button} alt="Delete Token Button"></BlockImage>

You will be presented with a form that will ask you to enter the current repository slug/identifier (this is to prevent accidental deletion of a token), and then click "Delete":

<BlockImage src={img_entitlement_token_delete_confirm} alt="Delete Token Confirmation Form"></BlockImage>

<Note variant="note">
  A deleted token will still be able to be used for static assets (that are cached at the Package Delivery Network) for approximately 10 minutes until the PDN has to re-authenticate once its cache expires.
</Note>

<Note variant="warning">
  Deleted Entitlement Tokens cannot be re-enabled.
</Note>