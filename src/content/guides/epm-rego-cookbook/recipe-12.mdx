import { CodeBlock, RemoteCodeBlock } from '@/components/CodeBlock';

# Recipe 12: Quarantine Debug Builds 

Identify and quarantine packages that look like debug/test artifacts based on filename or metadata patterns.

<RemoteCodeBlock
  lang="rego"
  src="https://raw.githubusercontent.com/cloudsmith-io/rego-recipes/refs/heads/main/recipe-12/policy.rego"
/>

**Trigger Condition:**

The below filename contains "**debug**" and will match your Rego pattern:  
pkg := input.v0["package"]  
re_match(".*(debug|test|tmp).*", pkg.filename)

**When and How It's Triggered**  
Your policy will trigger on:

- debugpy-1.6.7...whl  
- pytest-...tar.gz  
- mylib-test-1.0.0.tar.gz  
- tmp-utils-0.1.0.whl

Any of those filenames (if scanned by Cloudsmith after being uploaded or synced) would cause a match and return a reason like:  
Debug/test artifact detected in filename: debugpy-1.6.7-py2.py3-none-any.whl

Run the below command to download and push a package that matches the rule conditions:  
pip download --no-deps --dest . debugpy   
&& cloudsmith push python acme-corporation/acme-repo-one debugpy-1.8.14-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl -k "$CLOUDSMITH_API_KEY"

While it's unlikely you'll scope policy around debug builds in this manner, it's a great example of using regular expressions on package file names:

![][image13]![][image14]![][image15]

