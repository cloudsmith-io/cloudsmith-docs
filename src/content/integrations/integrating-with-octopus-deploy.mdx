# Integrating Octopus Deploy

import { BlockImage } from '@/components';
import { Note } from '@/components';
import screenshot6d9483c from './images/octopus-deploy/6d9483c-screenshot.png';
import screenshot6eba1c8 from './images/octopus-deploy/6eba1c8-screenshot.png';
import screenshot9d80006 from './images/octopus-deploy/9d80006-screenshot.png';
import screenshot29a120f from './images/octopus-deploy/29a120f-screenshot.png';
import screenshot87d18b1 from './images/octopus-deploy/87d18b1-screenshot.png';
import screenshot8417c65 from './images/octopus-deploy/8417c65-screenshot.png';
import screenshota1bdaca from './images/octopus-deploy/a1bdaca-screenshot.png';
import screenshotb8f5c39 from './images/octopus-deploy/b8f5c39-screenshot.png';
import screenshotbb63608 from './images/octopus-deploy/bb63608-screenshot.png';
import screenshotc8bc307 from './images/octopus-deploy/c8bc307-screenshot.png';
import screenshotff13d50 from './images/octopus-deploy/ff13d50-screenshot.png';

How to integrate Octopus Deploy with Cloudsmith

[Octopus Deploy](https://octopus.com/) is a deployment tool. It takes the packages and artifacts generated by your build server and deploys them to various targets, be it Windows, Linux, Azure, AWS, or Kubernetes, in a safe and consistent process.

Cloudsmith can easily be configured to be an external feed for Octopus Deploy to consume.

## Create an Octopus Account

You can install a self-hosted instance of the Octopus Server or use the hosted version Octopus Cloud. You can get started with either Octopus Server or Octopus Cloud for [free](https://octopus.com/start).

Once you have registered you can follow Octopus's instructions to [get started](https://octopus.com/docs/getting-started/first-deployment) with Octopus Deploy. 

Our instructions to add a Cloudsmith Feed will assume you are using an Octopus Cloud account but similar instructions apply to Octopus Server.

## Create a Cloudsmith Repository

After you have created your [Cloudsmith repository](/repositories/create-a-repository) you can add your details to the external feed of your Octopus Deploy build.

## Create the External Feed in Octopus

Log into your Octopus control centre and navigate to the Octopus dashboard for your Organization. 

Navigate to your Organisations Cloud instance, by clicking the _View_ button and selecting your plan. 
<BlockImage src={screenshotb8f5c39} alt="" align="left"></BlockImage>

Then navigate to your Octopus app, by selecting the link on the top right.
<BlockImage src={screenshotc8bc307} alt="" align="left"></BlockImage>

Select the Library tab.
<BlockImage src={screenshot6d9483c} alt="" align="left"></BlockImage>

Then, create a new Octopus Feed by navigating to **External Feeds->Add Feed**.
<BlockImage src={screenshot87d18b1} alt="" align="left"></BlockImage>

<BlockImage src={screenshot8417c65} alt="" align="left"></BlockImage>

In the _Create Feed_ page:

- Select the Feed type (NuGet, Helm, Docker, Maven), 
- Give the feed a name and in the URL field, enter the HTTP/HTTPS URL of your Cloudsmith repository. For more information on the URL Feed follow the [section below](#urls-for-feeds)
- Populate the credentials of your Cloudsmith repository if necessary. For more information on the URL Feed follow the [section below](#adding-credentials-for-private-repositories)
<BlockImage src={screenshota1bdaca} alt="" align="left"></BlockImage>

## URLs for Feeds

This section contains information about what Cloudsmith feed URL to use for your specific package.

### NuGet

Create a new Octopus Feed by navigating to **Library->External Feeds** and selecting the _NuGet_ Feed type.
<BlockImage src={screenshot29a120f} alt="" align="left"></BlockImage>

- Give the NuGet feed a name
- Enter the HTTP/HTTPS URL of the feed for your Cloudsmith NuGet repository following the instructions in the box below: 

```text NuGet V3
https://nuget.cloudsmith.io/OWNER/REPOSITORY/v3/index.json
```
```text NuGet V2
https://nuget.cloudsmith.io/OWNER/REPOSITORY/v2
```

Private repositories require authentication- refer to the [section below](#adding-credentials-for-private-repositories) for information on how to add your credentials.

### Docker

Create a new Octopus Feed by navigating to **Library->External Feeds** and selecting the _Docker Container Registry_ Feed type.
<BlockImage src={screenshot9d80006} alt="" align="left"></BlockImage>

- Give the Docker feed a name
- Enter the HTTP/HTTPS URL of the feed for your Cloudsmith Docker repository following the instructions in the box below: 

```
https://docker.cloudsmith.io/v2/OWNER/REGISTRY/
```

Private repositories require authentication- refer to the [section below](#adding-credentials-for-private-repositories) for information on how to add your credentials.

### Maven

Create a new Octopus Feed by navigating to **Library->External Feeds** and selecting the _Maven_ Feed type.
<BlockImage src={screenshotbb63608} alt="" align="left"></BlockImage>

- Give the feed a name
- Enter the HTTP/HTTPS URL of the feed for your Cloudsmith Maven repository following the instructions in the box below: 

```text Public URL with no authentication
https://dl.cloudsmith.io/public/OWNER/REPOSITORY/maven/
```
```text Entitlement Token Authentication
https://dl.cloudsmith.xyz/TOKEN/OWNER/REPOSITORY/maven/
```
```text HTTP Basic Authentication
https://dl.cloudsmith.io/basic/cloudsmith-test/ciara-repo1/maven/
```

Private repositories require authentication- refer to the [section below](#adding-credentials-for-private-repositories) for information on how to add your credentials.

### Helm

Create a new Octopus Feed by navigating to **Library->External Feeds** and selecting the _Helm_ Feed type.
<BlockImage src={screenshot6eba1c8} alt="" align="left"></BlockImage>

- Give the feed a name
- Enter the HTTP/HTTPS URL of the feed for your Cloudsmith Helm repository following the instructions in the box below:

```shell Entitlement Token Authentication
https://dl.cloudsmith.io/TOKEN/OWNER/REPOSITORY/helm/charts/
```
```text Public URL with no authentication
https://dl.cloudsmith.io/public/OWNER/REPOSITORY/helm/charts/
```
```text
https://dl.cloudsmith.io/basic/OWNER/REPOSITORY/helm/charts/
```

Private repositories require authentication- refer to the [section below](#adding-credentials-for-private-repositories) for information on how to add your credentials.

## Adding Credentials for Private Repositories

Private Cloudsmith repositories require authentication. If you used a token in the URL then you do not need to add additional credentials. 

<Note variant="note" headline="Private Repositories">
Private Cloudsmith repositories require authentication.  You can choose between two types of authentication, Entitlement Token Authentication or HTTP Basic Authentication. 
The setup method will differ depending on what authentication type you choose to use.
</Note>

<Note variant="warning" headline="Warning">
Entitlement Tokens, User Credentials and API-Keys should be treated as secrets, and you should ensure that you do not commit them in configurations files along with source code, or expose them in any logs.
</Note>
When you are adding or editing your external feed, you can add credentials for your feed by populating the _Credentials_ section. 
<BlockImage src={screenshotff13d50} alt="" align="left"></BlockImage>

Provide one of the following three types of credentials:

- Cloudsmith Username and Password
- Cloudsmith API Key
- An Entitlement Token

These will be populated in the Credentials section of the Octopus External Feed. 

```text Username + password
Feed username: USERNAME
Feed password: PASSWORD
```
```text API Key
Feed username: USERNAME
Feed password: API-KEY
```
```text Entitlement Token
Feed username: token
Feed password: TOKEN
```

For more information about credentials check [here](/package-formats/docker-registry#private-registries).
