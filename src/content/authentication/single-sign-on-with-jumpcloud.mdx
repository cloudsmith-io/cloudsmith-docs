import { BlockImage } from '@/components'
import imgc1598b2_pipFfKJ from './images/single-sign-on-with-jumpcloud/c1598b2-pipFfKJ.png'
import imgb5ded7f_gSKo4qI from './images/single-sign-on-with-jumpcloud/b5ded7f-gSKo4qI.png'
import img5705a68_EvV1GHE from './images/single-sign-on-with-jumpcloud/5705a68-EvV1GHE.png'
import img4b4ae82_f5U5xlF from './images/single-sign-on-with-jumpcloud/4b4ae82-f5U5xlF.png'
import img010954d_HngkhoO from './images/single-sign-on-with-jumpcloud/010954d-HngkhoO.png'
import img8e49768_hAcXDjT from './images/single-sign-on-with-jumpcloud/8e49768-hAcXDjT.png'
import img6ac1691_dne84If from './images/single-sign-on-with-jumpcloud/6ac1691-dne84If.png'
import imgc7d5fa2_tCKJUzh from './images/single-sign-on-with-jumpcloud/c7d5fa2-tCKJUzh.png'
import img4f06940_YNKiBAY from './images/single-sign-on-with-jumpcloud/4f06940-YNKiBAY.png'
import img14d937d from './images/single-sign-on-with-jumpcloud/14d937d-Screen_Shot_2019-07-31_at_09.29.21.png'
import img12f15d0_eyaqxsG from './images/single-sign-on-with-jumpcloud/12f15d0-eyaqxsG.png'
import img6807aa0_HVGiBNc from './images/single-sign-on-with-jumpcloud/6807aa0-HVGiBNc.png'
import img7fddf0b_RaB77x7 from './images/single-sign-on-with-jumpcloud/7fddf0b-RaB77x7.png'
import img78a10a8_MJw13iE from './images/single-sign-on-with-jumpcloud/78a10a8-MJw13iE.png'
import img4bbef67_9T6Ib4y from './images/single-sign-on-with-jumpcloud/4bbef67-9T6Ib4y.png'

# Single Sign-On with JumpCloud

This guide provides step-by-step instructions on setting up [JumpCloud](https://jumpcloud.com/) as a SAML IdP for your Cloudsmith Organization.

## Adding Cloudsmith to JumpCloud

Cloudsmith is not (yet) an integrated application in JumpCloud. You'll have to add Cloudsmith manually so you can configure SSO.

### Step 1

Log in as an administrator to JumpCloud, choose **Applications** from the sidebar and use the green **+** icon to add a new application:

<BlockImage src={imgc1598b2_pipFfKJ} alt=""></BlockImage>

### Step 2
Choose the generic SAML connector (usually first in the list, labelled **SAML**) and hit **Configure**:

<BlockImage src={imgb5ded7f_gSKo4qI} alt=""></BlockImage>

### Step 3
On the configuration screen, enter the **Display Label** as "Cloudsmith", and optionally choose a colour for the application.

<BlockImage src={img5705a68_EvV1GHE} alt=""></BlockImage>

### Step 4
Next, you'll need to choose an **IdP entity ID**, which is just a unique string used to identify this application/connector with JumpCloud. It doesn't matter what you use, so long as it's unique within your JumpCloud account. For example purposes we use "JumpCloud-Cloudsmith":

<BlockImage src={img4b4ae82_f5U5xlF} alt=""></BlockImage>

### Step 5
For the next step, you'll need to generate a public and private key used to sign and secure communication between JumpCloud and Cloudsmith (if you don't already have them). JumpCloud have [their own docs](https://jumpcloud.com/support/saml-configuration-notes) on exactly how to generate these keys depending on your operating system. Once generated, upload the private and public keys using the next two fields in the form:

<BlockImage src={img010954d_HngkhoO} alt=""></BlockImage>

### Step 6
Next, we'll fill in **SP Entity ID** and **ACS URL** with the same value. To determine the value we use the following format: `https://app.cloudsmith.com/WORKSPACE/saml/acs/`, where "WORKSPACE" is replaced with your organization's slug e.g. for the `cloudsmith` org we use `https://app.cloudsmith.com/cloudsmith/saml/acs/`:

<BlockImage src={img8e49768_hAcXDjT} alt=""></BlockImage>

### Step 7
We then need to configure the SAML Name ID attribute. We want to choose `email` and the appropriate `emailAddress` format:

<BlockImage src={img6ac1691_dne84If} alt=""></BlockImage>

### Step 8
Cloudsmith requires that users are identified by a first and last name, so we'll need to configure JumpCloud to send those too. Under **User Attributes** click **add attribute** and enter first/last name _exactly_ as follows:

<BlockImage src={imgc7d5fa2_tCKJUzh} alt=""></BlockImage>

### Step 9
Almost there, we need to check the box labelled **Sign Assertion**:

<BlockImage src={img4f06940_YNKiBAY} alt=""></BlockImage>

### Step 10
Check the box labelled **Declare redirect endpoint**:

<BlockImage src={img14d937d} alt=""></BlockImage>

### Step 11
And finally, choose an appropriate IdP URL, which must be unique in your account (`cloudsmith` is fine, unless you have more than one connector).

<BlockImage src={img12f15d0_eyaqxsG} alt=""></BlockImage>

### Step 12
Hit the green **Activate** button in the bottom right to complete your configuration:

<BlockImage src={img6807aa0_HVGiBNc} alt=""></BlockImage>

### Step 13
Your application is now configured on JumpCloud and you can add users and groups as required using the **Users** tab in the sidebar:

<BlockImage src={img7fddf0b_RaB77x7} alt=""></BlockImage>

## Providing configuration to Cloudsmith

Once configured as above, you'll need to provide metadata to Cloudsmith to connect to your newly configured IdP.

At the bottom-right of the form, right beside the **Activate** button from the previous step you'll see an **Export Metadata** button. Click it and an XML file containing metadata will be downloaded:

<BlockImage src={img78a10a8_MJw13iE} alt=""></BlockImage>

Take this file and add the XML contents to your [SAML settings](/authentication/single-sign-on#enable-saml) in your Cloudsmith organization.

## All wrapped up

The Cloudsmith application should now appear on the JumpCloud portal as normal:

<BlockImage src={img4bbef67_9T6Ib4y} alt=""></BlockImage>

You can then enable SAML in your Cloudsmith [SAML settings](/authentication/single-sign-on#enable-saml). 

You'll be able to access the landing page of your organization at the following URL: `https://app.cloudsmith.com/WORKSPACE/saml/login/`.

Where _WORKSPACE_ is your organization's slug/identifier (what you would normally see in the URL when accessing your organization within Cloudsmith).
