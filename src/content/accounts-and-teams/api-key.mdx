---
title: "API Key"
---

import { BlockImage } from '@/components';
import apiKeyImage from './images/api-key-1.png';
import refreshKeyImage from './images/api-key-refresh.png';
import apiIpRestrictions from './images/api-ip-restrictions.png';


# API Key

In order to use the [Cloudsmith API](/api), or any other integrations or tools that make use of the Cloudsmith API, you will first need to get your API Key.

An API Key provides Read and Write access. If you want Read-only access, please use an [Entitlement Token](/software-distribution/entitlement-tokens). API Keys and Entitlement Tokens should be treated as secrets to prevent unwarranted access.

## Getting your API Key

There are two ways to retrieve your API Key:

- Via the Cloudsmith web app
- Via the Cloudsmith CLI

### Via the Cloudsmith web app

On the top right corner, click on your user icon, then click on [Personal API Keys](https://app.cloudsmith.com/settings/api-keys) and click **Refresh** to view the API Key. Refreshing the API key will permanently disable the current API key. Make sure you store it in a proper secret management tool to access it later.

<BlockImage src={apiKeyImage} alt="Edit provider settings"></BlockImage>

### Via the Cloudsmith CLI

You can retrieve your API key using the cloudsmith login command:

```
cloudsmith login
Login: you@example.com
Password: PASSWORD
Repeat for confirmation: PASSWORD
```

> Please ensure you use your email for the 'Login' prompt.

## Adding IP-Based restrictions to your API-Key

By default, you can use your API-Key from anywhere. 

If you wish to restrict the use of your API-Key to a specific IP address or range, you can add the CIDR address/mask to the Allow List in the [API Key Restrictions](https://app.cloudsmith.com/settings/api-keys/restrictions) tab: 

<BlockImage src={apiIpRestrictions} alt="Setting API restrictions for a user API key"></BlockImage>

One you have added your CIDR address/mask, just click the "+ Add" button to apply your restriction.

## Refreshing a Personal/User API Key from the webapp

If you lose the API key associated with your account, or suspect it has been compromised, you'll need to refresh the key, generating a new one. 

To do this, under your profile menu, select Personal API Keys.
<BlockImage src={apiKeyImage} alt="Personal key menu item"></BlockImage>

Click the "Refresh API Key" button to generate a new API key.  
<BlockImage src={refreshKeyImage} alt="Refreshing the key"></BlockImage>

## Refreshing a Personal/User API Key from the Cloudsmith CLI ##

This script uses SSO to login, grab the API key and workspace id. Just change the ORG_NAME to the your workspace id and you should be all set.

```
#!/bin/bash

ORG_NAME="cloudsmith"

# Step 1: Authenticate
cloudsmith auth -o $ORG_NAME

# List tokens for user and extract the slug_perm (grabbing the first for simplicity)
SLUG_PERM=$(cloudsmith tokens ls -F json | jq -r '.data[0].slug_perm')

# Now refresh the token to get a key valid for 2 hours, then export it for use
NEW_KEY=$(cloudsmith tokens refresh $SLUG_PERM -F json | grep '^{' | jq '.data.key')

echo "New API Key: $NEW_KEY"
export CLOUDSMITH_API_KEY=$NEW_KEY

# Step 4: Verify we're logged in
cloudsmith whoami
```
